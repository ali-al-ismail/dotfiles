# Shared environment variables.
source ~/.shared_shell.sh

# Powerlevel10k theme
source /usr/share/zsh-theme-powerlevel10k/powerlevel10k.zsh-theme
source ~/.p10k.zsh
# Fish-like autosuggestions
source /usr/share/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh
# Syntax highlighting
source /usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
# History substring search
source /usr/share/zsh/plugins/zsh-history-substring-search/zsh-history-substring-search.zsh
# fzf
source /usr/share/fzf/completion.zsh
source /usr/share/fzf/key-bindings.zsh

# Enable vi mode
bindkey -v

## Options
# Append history instead of overwriting it for every session
setopt appendhistory
# If a new command is a duplicate, remove the older one
setopt histignorealldups
# Don't save commands that start with space
setopt histignorespace

autoload -Uz compinit -d "$XDG_CACHE_HOME"/zsh/zcompdump-"$ZSH_VERSION" && compinit -d "$XDG_CACHE_HOME"/zsh/zcompdump-"$ZSH_VERSION"
# Case insensitive tab completion
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}' 'r:|=*' 'l:|=* r:|=*'
# Colored completion (different colors for dirs/files/etc)
zstyle ':completion:*' list-colors "${(s.:.)LS_COLORS}"
# automatically find new executables in path
zstyle ':completion:*' rehash true
# Speed up completions
zstyle ':completion:*' accept-exact '*(N)'
zstyle ':completion:*' use-cache on
zstyle ':completion:*' cache-path ~/.cache/zsh
export HISTFILE="$XDG_STATE_HOME/zsh/history"
HISTSIZE=100000
SAVEHIST=100000
# Don't consider certain characters part of the word
WORDCHARS=${WORDCHARS//\/[&.;]}

## Key bindings
# Home key
bindkey '^[[H' beginning-of-line
# End key
bindkey '^[[F' end-of-line
# Navigate words with ctrl+arrow keys
bindkey '^[[1;5D' backward-word
bindkey '^[[1;5C' forward-word
bindkey '^H' backward-kill-word
bindkey '^[[Z' undo
# bind UP and DOWN arrow keys to history substring search
zmodload zsh/terminfo
bindkey "$terminfo[kcuu1]" history-substring-search-up
bindkey "$terminfo[kcud1]" history-substring-search-down
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down

# Keybindings for dragon-drop
bindkey -s '^b' "dragto "
bindkey -s '^n' "dragon^J"

# Color man pages
export LESS_TERMCAP_mb=$'\E[01;32m'
export LESS_TERMCAP_md=$'\E[01;32m'
export LESS_TERMCAP_me=$'\E[0m'
export LESS_TERMCAP_se=$'\E[0m'
export LESS_TERMCAP_so=$'\E[01;47;34m'
export LESS_TERMCAP_ue=$'\E[0m'
export LESS_TERMCAP_us=$'\E[01;36m'
export LESS=-R

export EDITOR="nvim"
export VISUAL="nvim"
export TERMINAL="kitty"
export VIDEO="mpv"
export IMAGE="feh"
export OPENER="handlr open"

# Tools/Programmes aliases
alias nv="nvim"
alias snv="sudoedit"
alias py='python'
alias ipy='ipython'
alias topdf='libreoffice --headless --invisible --convert-to pdf'
alias now="date +'%A %d/%m/%Y %H:%M:%S.%N (%Z) %nUnix time: %s'"
alias cp="cp -i"
alias df="df -h"
alias free="free -m"
alias grep="grep --colour=always"
alias n="nnn"
alias feh="feh --scale-down"
# Kitty's kittens aliases
alias ssh="kitty +kitten ssh"
alias icat="kitty +kitten icat"
# ls aliases
alias ls="exa --icons"
alias ll="exa -l --icons"
alias la="exa -la --icons"
# To not shoot my self in the leg.
alias del='rmtrash'
alias deldir='rmdirtrash'
alias rm="echo -e Use 'del', or the full path i.e. '/bin/rm'. Can't delete: "
# for dragon-drop
alias dragto="dragon-drop"
alias dragon="dragon-drop --target --and-exit"


# Clipcat integration
if type clipcat-menu >/dev/null 2>&1; then
	alias clipedit=' clipcat-menu --finder=builtin edit'
	alias clipdel=' clipcat-menu --finder=builtin remove'

	bindkey -s '^\' "^Q clipcat-menu --finder=builtin insert ^J"
	bindkey -s '^]' "^Q clipcat-menu --finder=builtin remove ^J"
fi


# Zoxide integration
eval "$(zoxide init zsh --cmd cd)"

# nnn configuarations
export NNN_PLUG='j:autojump'

# virtualenvwrapper
export WORKON_HOME=$XDG_DATA_HOME/virtualenvs
source /usr/bin/virtualenvwrapper_lazy.sh

# Some configuarations are from manjaro-zsh-config
# https://github.com/Chrysostomus/manjaro-zsh-config
